(self["webpackChunkitcast_toutiao"]=self["webpackChunkitcast_toutiao"]||[]).push([[441],{6441:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return P}});var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("div",[t("van-nav-bar",{attrs:{fixed:"",title:"头条仿制"},scopedSlots:e._u([{key:"left",fn:function(){return[t("van-icon",{attrs:{name:"fire-o",color:"#ee0a24",size:"0.48rem"}})]},proxy:!0},{key:"right",fn:function(){return[t("van-icon",{attrs:{name:"search",size:"0.48rem",color:"#fff"},on:{click:function(n){return e.$router.push("/search")}}})]},proxy:!0}])})],1),t("div",{staticClass:"main"},[t("van-tabs",{attrs:{animated:"",sticky:"","offset-top":"1.226667rem"},model:{value:e.channelId,callback:function(n){e.channelId=n},expression:"channelId"}},e._l(e.channelList,(function(n){return t("van-tab",{key:n.id,attrs:{title:n.name,name:n.id}},[t("ArticleList",{attrs:{cid:e.channelId}})],1)})),1),t("van-icon",{staticClass:"moreChannels",attrs:{name:"plus",size:"0.37333334rem"},on:{click:function(n){e.show=!0}}})],1),t("van-popup",{staticClass:"edit_wrap",model:{value:e.show,callback:function(n){e.show=n},expression:"show"}},[t("ChannelEdit",{attrs:{userChannelList:e.channelList},on:{close:function(n){e.show=!1},addChannel:e.addChannelFn,removeChannel:e.removeChannelFn,changeChannel:e.channgeChannelFn}})],1)],1)},a=[],i=t(1797),s=t(9873),c=(t(7327),t(1539),t(1249),t(8309),t(4553),t(561),t(3040),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(n){e.isLoading=n},expression:"isLoading"}},[t("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",offset:"50"},on:{load:e.onLoad},model:{value:e.loading,callback:function(n){e.loading=n},expression:"loading"}},e._l(e.articleList,(function(n){return t("article-item",{key:n.art_id,attrs:{value:n},on:{disLike:e.disLikeFn,reports:e.reportsFn},nativeOn:{click:function(t){return e.$router.push("/article_detail?aid="+n.art_id)}}})})),1)],1)],1)}),o=[],u=(t(691),t(2249)),l=t(156),d=(t(9653),t(4747),t(2222),t(1703),t(3056)),h={props:{cid:Number},mounted:function(){},created:function(){this.getArticlesListData()},data:function(){return{articleList:[],loading:!1,finished:!1,nextTime:null,isLoading:!1}},methods:{getArticlesListData:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$API.articlesListAPI({channelId:e.cid,timestamp:e.nextTime});case 3:t=n.sent,t.data.data.results.forEach((function(e){e.pubdate=(0,d.S)(e.pubdate)})),0===t.data.data.results.length?e.finished=!0:(e.nextTime=t.data.data.pre_timestamp,e.articleList=[].concat((0,l.Z)(e.articleList),(0,l.Z)(t.data.data.results)),e.loading=!1),n.next=11;break;case 8:return n.prev=8,n.t0=n["catch"](0),n.abrupt("return",Promise.reject(new Error(n.t0)));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},onLoad:function(){this.articleList.length>0&&this.getArticlesListData()},onRefresh:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.nextTime=null,e.articleList=[],n.prev=2,n.next=5,e.getArticlesListData();case 5:e.isLoading=!1,n.next=11;break;case 8:return n.prev=8,n.t0=n["catch"](2),n.abrupt("return",Promise.reject(n.t0));case 11:case"end":return n.stop()}}),n,null,[[2,8]])})))()},disLikeFn:function(e){var n=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.$API.articleDislikeAPI({target:e.art_id});case 3:(0,u.Z)({type:"success",message:"反馈成功"}),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),(0,u.Z)({type:"warning",message:"反馈失败-联系程序员"});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},reportsFn:function(e,n){var t=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$API.articleReportsAPI({target:e.art_id,type:n,remark:"就是其他问题"});case 3:(0,u.Z)({type:"success",message:"举报成功"}),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),(0,u.Z)({type:"warning",message:"举报失败"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()}}},f=h,p=t(1001),m=(0,p.Z)(f,c,o,!1,null,"6d432726",null),v=m.exports,g=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("van-nav-bar",{attrs:{title:"我的频道"},scopedSlots:e._u([{key:"right",fn:function(){return[t("van-icon",{attrs:{name:"cross",size:"0.37333334rem",color:"white"},on:{click:e.closeFn}})]},proxy:!0}])}),t("div",{staticClass:"my-channel-box"},[t("div",{staticClass:"channel-title"},[t("span",[e._v("我的频道 "),t("span",{staticClass:"small-title"},[e._v(" "+e._s(e.isEdit?"点击删除频道":"点击进入频道")+" ")])]),t("span",{on:{click:function(n){e.isEdit=!e.isEdit}}},[e._v(e._s(e.isEdit?"完成":"编辑"))])]),t("van-row",{attrs:{type:"flex"}},e._l(e.userChannelList,(function(n){return t("van-col",{key:n.id,attrs:{span:"6"},on:{click:function(t){return e.removeFn(n)}}},[t("div",{staticClass:"channel-item van-hairline--surround"},[e._v(" "+e._s(n.name)+" "),e.isEdit&&"推荐"!=n.name?t("van-badge",{staticClass:"cross-badge",attrs:{color:"transparent"},scopedSlots:e._u([{key:"content",fn:function(){return[t("van-icon",{staticClass:"badge-icon",attrs:{name:"cross",color:"#cfcfcf",size:"0.32rem"}})]},proxy:!0}],null,!0)}):e._e()],1)])})),1)],1),t("div",{staticClass:"more-channel-box"},[e._m(0),t("van-row",{attrs:{type:"flex"}},e._l(e.unChannelList,(function(n){return t("van-col",{key:n.id,attrs:{span:"6"},on:{click:function(t){return e.addFn(n)}}},[t("div",{staticClass:"channel-item van-hairline--surround"},[e._v(e._s(n.name))])])})),1)],1)],1)},w=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"channel-title"},[t("span",[e._v("点击添加更多频道：")])])}],b={props:{userChannelList:{type:Array,default:function(){return[]}}},data:function(){return{allChannelList:[],isEdit:!1}},created:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$API.getAllChannelsAPI();case 3:t=n.sent,e.allChannelList=t.data.data.channels,n.next=10;break;case 7:return n.prev=7,n.t0=n["catch"](0),n.abrupt("return",Promise.reject(n.t0));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},computed:{unChannelList:function(){var e=this;return this.allChannelList.filter((function(n){var t=e.userChannelList.findIndex((function(e){return e.id===n.id}));if(-1===t)return!0}))}},methods:{addFn:function(e){!0===this.isEdit&&this.$emit("addChannel",e)},removeFn:function(e){!0===this.isEdit&&"推荐"!==e.name?this.$emit("removeChannel",e):(this.$emit("changeChannel",e),this.$emit("close"))},closeFn:function(){this.$emit("close"),this.isEdit=!1}}},x=b,C=(0,p.Z)(x,g,w,!1,null,"04c2b44e",null),k=C.exports,L={components:{ArticleList:v,ChannelEdit:k},data:function(){return{channelId:0,channelList:[],show:!1}},mounted:function(){this.getUserChannelData()},methods:{getUserChannelData:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$API.userChannelAPI();case 3:t=n.sent,e.channelList=t.data.data.channels,n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),e.$router.push("/login");case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},updateChannel:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function n(){var t,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e.channelList.filter((function(e){return 0!=e.id})),r=t.map((function(e,n){var t=(0,i.Z)({},e);return t.seq=n+1,delete t.name,t})),n.next=4,e.$API.updateChannelAPI({channels:r});case 4:case"end":return n.stop()}}),n)})))()},addChannelFn:function(e){var n=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.channelList.push(e),n.updateChannel();case 2:case"end":return t.stop()}}),t)})))()},removeChannelFn:function(e){var n=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.channelList.findIndex((function(n){return n.id===e.id})),n.channelList.splice(r,1),n.updateChannel();case 3:case"end":return t.stop()}}),t)})))()},channgeChannelFn:function(e){this.channelId=e.id}}},y=L,_=(0,p.Z)(y,r,a,!1,null,"f7eb9c2c",null),P=_.exports},4553:function(e,n,t){"use strict";var r=t(2109),a=t(2092).findIndex,i=t(1223),s="findIndex",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),r({target:"Array",proto:!0,forced:c},{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i(s)},9337:function(e,n,t){var r=t(2109),a=t(9781),i=t(3887),s=t(5656),c=t(1236),o=t(6135);r({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var n,t,r=s(e),a=c.f,u=i(r),l={},d=0;while(u.length>d)t=a(r,n=u[d++]),void 0!==t&&o(l,n,t);return l}})},1797:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});t(7941),t(2526),t(7327),t(1539),t(5003),t(4747),t(9337);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}}}]);
//# sourceMappingURL=441-legacy.8872e29f.js.map